<!DOCTYPE html>
<html>

<head>
  <title>grid viewer</title>

  <style>
    #grid {
      position: relative;
    }

    .base {
      width: 100%;
    }

    .hover {
      position: absolute;
      left: 0;
      top: 0;
      max-width: 500px;
      max-height: 500px;
    }
  </style>
</head>

<body>

  <div id="grid">
    <img class="base" src="colors-v4-tSNE-grid.jpg" />
  </div>

  <script type="text/javascript">
    var grid = document.getElementById("grid")
    var columns = 53
    var rows = 43
    var last_row = -1;
    var last_col = -1;
    var points, imagexy = {};
    var hover = new Image();
    hover.classList.add("hover")
    grid.appendChild(hover);
    var xmlhttp = new XMLHttpRequest(),
      method = 'GET',
      url = './colors-v4-tSNE-grid-points.json';

    xmlhttp.open(method, url, true);
    xmlhttp.onload = function (data) {
      points = JSON.parse(data.target.response)
      points.forEach(p => {
        imagexy[p.point[0] + "" + p.point[1]] = p.path
      })
      init();
    };
    xmlhttp.send()
    function init() {
      grid.addEventListener("mousemove", function (e) {
        var nx = e.layerX / grid.clientWidth;
        var ny = e.layerY / grid.clientHeight;
        var row = Math.floor(ny * rows)
        var col = Math.floor(nx * columns)
        if (row != last_row || col != last_col) {
          last_col = col;
          last_row = row;
          hover.src = imagexy[col + "" + row].replace("/Users/mga/Documents/website/cv", "");
          console.log(imagexy[col + "" + row])
        }
        var w = hover.width ? hover.width : 0;
        var h = hover.height ? hover.height : 0;
        var x = e.layerX - (w / 2);
        var y = e.layerY - h - 20;
        if (x < 0) x = 0;
        if (x + w > grid.clientWidth) x = grid.clientWidth - w;
        if (y < 0) y = e.layerY + 20;
        hover.setAttribute("style", "left: " + x + "px; top: " + y + "px;");
      })
    }
  </script>

</body>

</html>